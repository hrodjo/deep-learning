Analysis and Optimization of Graph Decompositions by Lifted Multicuts

Andrea Horňáková * 1 Jan-Hendrik Lange * 1 Bjoern Andres 1

Abstract
We study the set of all decompositions (clusterings) of a graph through its characterization as
a set of lifted multicuts. This leads us to practically relevant insights related to the definition
of classes of decompositions by must-join and
must-cut constraints and related to the comparison of clusterings by metrics. To find optimal
decompositions defined by minimum cost lifted
multicuts, we establish some properties of some
facets of lifted multicut polytopes, define efficient
separation procedures and apply these in a branchand-cut algorithm.

1. Introduction
This article is about the set of all decompositions (clusterings) of a graph. A decomposition of a graph G = (V, E)
is a partition Π of the node set V such that, for every subset
U ∈ Π of nodes, the subgraph of G induced by U is connected. An example is depicted in Fig. 1. Decompositions
of a graph arise in practice, as feasible solutions of clustering problems, and in theory, as a generalization of partitions
of a set, to which they specialize for complete graphs.
We study the set of all decompositions of a graph through
its characterization as a set of multicuts. A multicut of G is
a subset M ⊆ E of edges such that, for every (chordless)
cycle C ⊆ E of G, we have |M ∩ C| 6= 1. An example is
depicted in Fig. 1. For any graph G, a one-to-one relation
exists between the decompositions and the multicuts of G.
The multicut induced by a decomposition is the set of edges
that straddle distinct components. Multicuts are useful in
the study of decompositions as the characteristic function
x ∈ {0, 1}E of a multicut x−1 (1) of G makes explicit, for
every pair {v, w} ∈ E of neighboring nodes, whether v and
w are in distinct components. To make explicit also for nonneighboring nodes, specifically, for all {v, w} ∈ E 0 with
*

Equal contribution 1 Max Planck Institute for Informatics,
Saarbrücken, Germany. Correspondence to: Bjoern Andres
<andres@mpi-inf.mpg.de>.
Proceedings of the 34 th International Conference on Machine
Learning, Sydney, Australia, PMLR 70, 2017. Copyright 2017 by
the author(s).

Figure 1. A decomposition of a graph is a partition of the node
set into connected subsets. Above, one decomposition is depicted
in green. Any decomposition is characterized by the set of those
edges (depicted as dotted lines) that straddle distinct components.
Such edge sets are precisely the multicuts of the graph.


E ⊆ E 0 ⊆ V2 , whether v and w are in distinct components,
we define a lifting of the multicuts of G to multicuts of
G0 = (V, E 0 ). The multicuts of G0 lifted from G are still in
one-to-one relation with the decompositions of G. Yet, they
are a more expressive model of these decompositions than
the multicuts of G. We apply lifted multicuts in three ways:
Firstly, we study problems related to the definition of a class
of decompositions by must-cut or must-join constraints (Section 4). Such constraints have applications where defining
a decomposition totally is an ambiguous and tedious task,
e.g., in the field of image segmentation. The first problem
is to decide whether a set of such constraints is consistent,
i.e., whether a decomposition of the given graph exists that
satisfies the constraints. We show that this decision problem is NP-complete in general and can be solved efficienty
for a subclass of constraints. The second problem is to
decide whether a consistent set of must-join and must-cut
constraints is maximally specific, i.e., whether no such constraint can be added without changing the set of decompositions that satisfy the constraints. We show that this decision
problem is NP-hard in general and can be solved efficienty
for a subclass of constraints. This finding is relevant for
comparing the classes of decompositions definable by mustjoin and must-cut constraints by certain metrics, which is
the next topic.
As a second application of lifted multicuts, we study the
comparison of decompositions and classes of decompositions by metrics (Section 5). To obtain a metric on the set of
all decompositions of a given graph, we define a metric on a
set of lifted multicuts that characterize these decompositions.

Analysis and Optimization of Graph Decompositions by Lifted Multicuts

0

0

1

0
e2

e1

e3

0

1

1

e1
G

0

1
1

1

xf

e2

0

1

G

xe3

1

x e1

xe2

e2

e1
G0

1

0

0

1

0
f

0

1
1

1
0

1

1
1

x e2

x e1

Figure 2. For any connected graph G (left), the characteristic functions of all multicuts of G (middle) span, as their convex hull
in RE , the multicut polytope of G (right), a 01-polytope that is
|E|-dimensional (Chopra & Rao, 1993).

Figure 3. For any connected graph G = (V, E) (top left) and any
graph G0 = (V, E 0 ) with E ⊆ E 0 (bottom left), those multicuts of
G0 that are lifted from G (middle) span, as their convex hull in RE ,
the lifted multicut polytope w.r.t. G and G0 (right), a 01-polytope
that is |E 0 |-dimensional (Thm. 7).

By lifting to different graphs, we obtain different metrics,
two of which are well-known and here generalized. To extend this metric to the classes of decompositions definable
by must-join and must-cut constraints, we define a metric on
partial lifted multicuts that characterize these classes, connecting results of Sections 4 and 5. We show that computing
this metric is NP-hard in general and efficient for a subclass
of must-join and must-cut constraints. These findings have
implications on the applicability of must-join and must-cut
constraints as a form of supervision, more specifically, on
the practicality of certain error metrics and loss functions.

The lifting of multicuts we define makes path connectedness explicit. For a single component, this is studied by
Nowozin & Lampert (2010) who introduce the connected
subgraph polytope and outer relaxations. Applications of
the minimum cost lifted multicut problem and experimental comparisons to the correlation clustering problem in
the field of computer vision are by Keuper et al. (2015)
and Tang et al. (2017) who find feasible solutions by local
search (Keuper et al., 2015; Levinkov et al., 2017), and by
Beier et al. (2017) who find feasible solutions by consensus
optimization (Beier et al., 2016). The complexity of several decision problems related to clustering with must-join
and must-cut constraints is established by Davidson & Ravi
(2007). Well-known metrics on the set of all decompositions
of a graph are the metric of Rand (1971) and the variation
of information (Meilă, 2007).

As a third application of lifted multicuts, we study the optimization of graph decompositions by minimum cost lifted
multicuts. The minimum cost lifted multicut problem is
a generalization of the correlation clustering problem. Its
applications in the field of computer vision are mentioned
below. To tackle this problem, we establish some properties
of some facets of lifted multicut polytopes (Fig. 2 and 3),
define efficient separation procedures and apply these in a
branch-and-cut algorithm.
1.1. Related Work
Initial motivation to study decompositions of a graph by
multicuts came from the field of polyhedral optimization.
Multicut polytopes are studied by Grötschel & Wakabayashi
(1989); Deza et al. (1991; 1992); Chopra & Rao (1993;
1995) and Deza & Laurent (1997) who characterize several
classes of their facets.
The binary linear program whose feasible solutions are all
multicuts of a graph is known as the correlation clustering
problem from the work of Bansal et al. (2004) and Demaine
et al. (2006) who establish its APX-hardness and a logarithmic approximation. The stability of its solutions is analyzed
by Nowozin & Jegelka (2009). Generalizations to multilinear objective functions are studied by Kim et al. (2014)
and Kappes et al. (2016). The problem remains NP-hard
for planar graphs (Voice et al., 2012; Bachrach et al., 2013)
where it admits a PTAS (Klein et al., 2015) and relaxations
that are often tight in practice (Yarkony et al., 2012).

2. Multicuts
Definition 1 Let G = (V, E) be any graph. A subgraph
G0 = (V 0 , E 0 ) of G is called a component of G iff G0 is
non-empty, node-induced1 , and connected2 . A partition Π
of V is called a decomposition
of G iff, for every U ∈ Π,

the subgraph (U, E ∩ U2 ) of G induced by U is connected
(and hence a component of G).
V

For any graph G, we denote by DG ⊂ 22 the set of all
decompositions of G. Useful in the study of decompositions
are the multicuts of a graph:
Definition 2 For any graph G = (V, E), a subset M ⊆ E
of edges is called a multicut of G iff, for every cycle C ⊆ E
of G, we have |C ∩ M | =
6 1.
Lemma 1 (Chopra & Rao, 1993) It is sufficient in Def. 2
to consider only the chordless cycles.
For any graph G, we denote by MG ⊆ 2E the set of all
multicuts of G. One reason why multicuts are useful in
0
That is: E 0 = E ∩ V2
2
We do not require a component to be maximal w.r.t. the subgraph relation.

1

Analysis and Optimization of Graph Decompositions by Lifted Multicuts

the study of decompositions is that, for every graph G, a
one-to-one relation exists between the decompositions and
the multicuts of G. An example is depicted in Fig. 1:
Lemma 2 For any graph G = (V, E), the map φG :
DG → 2E defined by (1) is a bijection from DG to MG .
∀Π ∈ DG ∀{v, w} ∈ E :
{v, w} ∈ φG (Π) ⇔ ∀U ∈ Π(v ∈
/ U ∨w ∈
/ U)

(1)

Another reason why multicuts are useful in the study of
decompositions is that, for any graph G = (V, E) and any
decomposition Π of G, the characteristic function of the
multicut induced by Π is a 01-encoding of Π of fixed length
|E|.
Lemma 3 (Chopra & Rao, 1993) For any graph G =
(V, E) and any x ∈ {0, 1}E , the set x−1 (1) of those edges
that are labeled 1 is a multicut of G iff (2) holds. It is
sufficient in (2) to consider only chordless cycles.
X
∀C ∈ cycles(G) ∀e ∈ C : xe ≤
x e0
(2)
e0 ∈C\{e}

For any graph G = (V, E), we denote by XG the set of all
x ∈ {0, 1}E that satisfy (2).
2.1. Complete Graphs
V
2



The decompositions of a complete graph KV := (V,
)
are precisely the partitions of the node set V (by Def. 1).
The multicuts of a complete graph KV relate one-to-one to
the equivalence relations on V :
Lemma 4 For any set V and the complete graph KV , the
map ψ : MKV → 2V ×V defined by (3) is a bijection between MKV and the set of all equivalence relations on V .
∀M ∈ MKV ∀v, w ∈ V :
(v, w) ∈ ψ(M ) ⇔ {v, w} ∈
/M

(3)

The bijection between the decompositions of a graph and the
multicuts of a graph (Lemma 2) specializes, for complete
graphs, to the well-known bijection between the partitions of
a set and the equivalence relations on the set (by Lemma 4).
In this sense, decompositions and multicuts of graphs generalize partitions of sets and equivalence relations on sets.

3. Lifted Multicuts
For any graph G = (V, E), the characteristic function x ∈
XG of a multicut x−1 (1) of G makes explicit, for every
pair {v, w} ∈ E of neighboring nodes, whether v and w
are in distinct components. To make explicit also for nonneighboring nodes,
specifically, for all {v, w} ∈ E 0 with

V
0
E ⊆ E ⊆ 2 , whether v and w are in distinct components,
we define a lifting of the multicuts of G to multicuts of
G0 = (V, E 0 ):

Definition 3 For any graphs G = (V, E) and G0 = (V, E 0 )
with E ⊆ E 0 , the composed map λGG0 := φG0 ◦ φ−1
G is
called the lifting of multicuts from G to G0 .
For any graphs G = (V, E) and G0 = (V, E 0 ) with E ⊆ E 0 ,
we introduce the notation FGG0 := E 0 \ E, for brevity.
Lemma 5 For any connected graph G = (V, E), any
0
graph G0 = (V, E 0 ) with E ⊆ E 0 and any x ∈ {0, 1}E ,
−1
0
the set x (1) is a multicut of G lifted from G iff
X
∀C ∈ cycles(G) ∀e ∈ C : xe ≤
x e0
(4)
e0 ∈C\{e}

∀vw ∈ FGG0 ∀P ∈ vw-paths(G) : xvw ≤

X

xe

(5)

X

(1 − xe )

e∈P

∀vw ∈ FGG0 ∀C ∈ vw-cuts(G) : 1 − xvw ≤

e∈C

(6)
For any graphs G = (V, E) and G0 = (V, E 0 ) with E ⊆ E 0
0
we denote by XGG0 the set of all x ∈ {0, 1}E that satisfy
(4)–(6).

4. Partial Lifted Multicuts
As a first application of lifted multicuts, we study the class
of decompositions of a graph definable by must-join and
must-cut constraints. For this, we consider partial functions.
For any set E, a partial characteristic function of subsets
of E is a function from any subset F ⊆ E to {0, 1}. With
some abuse of notation, we denote the set of all partial
characteristic
functions of subsets of E by {0, 1, ∗}E :=
S
F
E
F ⊆E {0, 1} . For any x ∈ {0, 1, ∗} , we denote the
−1
domain of x by dom x := x ({0, 1}).
For any connected graph G = (V, E) whose decompositions we care about and any graph G0 = (V, E 0 ) with
0
E ⊆ E 0 , we consider a partial function x̃ ∈ {0, 1, ∗}E . For
any {v, w} ∈ dom x̃, we constrain the nodes v and w to the
same component if x̃vw = 0 and to distinct components if
x̃vw = 1.
4.1. Consistency
A natural question to ask is whether a decomposition of the
graph G exists that satisfies these constraints. We show that
this decision problem is NP-complete.
Definition 4 For any connected graph G = (V, E), any
0
graph G0 = (V, E 0 ) with E ⊆ E 0 , and any x̃ ∈ {0, 1, ∗}E ,
the elements of
XGG0 [x̃] := {x ∈ XGG0 | ∀e ∈ dom x̃ : xe = x̃e }

(7)

are called the completions of x̃ in XGG0 . In addition, x̃ is
called consistent and a partial characterization of multicuts

Analysis and Optimization of Graph Decompositions by Lifted Multicuts

of G0 lifted from G iff
XGG0 [x̃] 6= ∅ .

(8)

We denote the set of all partial characterizations of multicuts
of G0 lifted from G by

n
o
0 
X̃GG0 := x̃ ∈ {0, 1, ∗}E  XGG0 [x̃] 6= ∅ . (9)
Theorem 1 Deciding consistency is NP-complete.
Lemma 6 Consistency can be decided efficiently if E ⊆
dom x̃ or
∀vw ∈ dom x̃ \ E :
x̃vw = 1 ∨ ∃P ∈ vw-path(G) ∀e ∈ P : x̃e = 0 (10)
4.2. Specificity
A less obvious question to ask for any partial characterization x̃ of multicuts of G0 lifted from G is whether x̃ is
maximally specific for its completions in XGG0 . In other
words, is there no edge e ∈ E 0 \ dom x̃ such that, for any
completions x, x0 of x̃ in XGG0 , we have xe = x0e , i.e., an
edge that could be included in dom x̃ without changing the
set of completions of x̃ in XGG0 ? We show that deciding
maximal specificity is NP-hard.
Definition 5 Let G = (V, E) a connected graph and G0 =
(V, E 0 ) a graph with E ⊆ E 0 . For any x̃ ∈ X̃GG0 , the edges
E 0 [x̃] := {e ∈ E 0 | ∀x, x0 ∈ XGG0 [x̃] : xe = x0e }

(11)

are called decided. The edges E 0 \ E 0 [x̃] are called undecided. Moreover, x̃ is called maximally specific iff3
0

Lemma 8 For any connected graph G = (V, E) and any
graph G0 = (V, E 0 ) with E ⊆ E 0 , specificity is a partial
order on X̃GG0 .
Note that two partial characterizations x̃, x̃0 ∈ X̃GG0 with
the same completions XGG0 [x̃] = XGG0 [x̃0 ] need not be
comparable w.r.t. ≤. For example, consider the graphs G, G0
from Fig. 3, consider x̃ : e1 7→ 0, e2 7→ 0 and x̃0 : f 7→ 0.
Nevertheless, we have the following lemma.
Lemma 9 For any connected graph G = (V, E), any
graph G0 = (V, E 0 ) with E ⊆ E 0 , any x̃ ∈ X̃GG0 and

n
o

X̃GG0 [x̃] := x̃0 ∈ X̃GG0  XGG0 [x̃0 ] = XGG0 [x̃] (14)
a maximum of X̃GG0 [x̃] w.r.t. ≤ exists and is unique. Moreover, x̃ is maximally specific in the sense of Def. 5 iff x̃ is
maximal w.r.t. ≤ in X̃GG0 [x̃].
Definition 7 Let G = (V, E) be a connected graph and let
G0 = (V, E 0 ) be a graph with E ⊆ E 0 . For any x̃ ∈ X̃GG0 ,
we call the unique maximum of X̃GG0 [x̃] w.r.t. ≤ the closure
of x̃ w.r.t. G and G0 and denote it by clGG0 x̃.
We denote by X̂GG0 the set of all maximally specific partial
characterizations of multicuts of G0 lifted from G, i.e.:

n
o

X̂GG0 := x̃ ∈ X̃GG0  x̃ = clGG0 x̃ .
(15)
Theorem 3 For any x̃, x̃0 ∈ X̃GG0 , we have XGG0 [x̃] =
XGG0 [x̃0 ] ⇔ X̃GG0 [x̃] = X̃GG0 [x̃0 ] ⇔ clGG0 x̃ = clGG0 x̃0 .
Lemma 10 For any connected graph G = (V, E), any
graph G0 = (V, E 0 ) with E ⊆ E 0 and any x ∈ XG , the
closure y := clGG0 x of x w.r.t. G and G0 coincides with the
lifting of the multicut x−1 (1) of G to the multicut y −1 (1) of
G0 , i.e.
(clGG0 x)−1 (1) = λGG0 (x−1 (1)) .

(16)

Theorem 2 Deciding maximal specificity is NP-hard.

Theorem 4 Computing closures is NP-hard.
Lemma 11 In the special case that E 0 = E or E ⊆ dom x̃,
the closure can be computed efficiently.

Lemma 7 Maximal specificity can be decided efficiently if
E 0 = E or E ⊆ dom x̃.

5. Metrics

E [x̃] ⊆ dom x̃ .

(12)

Below, we justify the term maximal specificity and define
an operation that maps any partial characterization of lifted
multicuts to one that is maximally specific.
Definition 6 For any connected graph G = (V, E) and
any graph G0 = (V, E 0 ) with E ⊆ E 0 , the relation ≤ on
X̃GG0 defined by (13) is called the specificity of partial
characterizations of multicuts of G0 lifted from G.
∀x̃, x̃0 ∈ X̃GG0 :
0

(13)
0

x̃ ≤ x̃ ⇔ dom x̃ ⊆ dom x̃ ∧ ∀e ∈ dom x̃ : x̃e = x̃0e
3
Note that (12) is equivalent to E 0 [x̃] = dom x̃, as E 0 [x̃] ⊇
dom x̃ holds by definition of E 0 [x̃].

5.1. Metrics on Decompositions
As a second application of lifted multicuts, we compare decompositions of a given graph by comparing lifted multicuts
that characterize these decompositions. We compare these
lifted multicuts by comparing their characteristic functions
by Hamming metrics: For any E 6= ∅ and any e ∈ E, we
define d1e , d1E : {0, 1}E × {0, 1}E → N+
0 by the forms
(
0 if xe = x0e
d1e (x, x0 ) =
(17)
1 otherwise
X
d1E (x, x0 ) =
d1e0 (x, x0 ) .
(18)
e0 ∈E

Analysis and Optimization of Graph Decompositions by Lifted Multicuts

dµE 0 (x, x0 ) :=

X

µe d1e (x, x0 )

(19)

e∈E 0

By the one-to-one relation between decompositions and
multicuts (Lemma 2), dµE 0 induces a pseudo-metric on the
set DG of all decompositions of G. Two special cases are
well-known: For E 0 = E and µ = 1, we have dµE 0 = d1E ,
which is the Hamming metric (18) on the multicuts that
characterize the decompositions, also known as
 the boundary metric on decompositions. For E 0 = V2 and µ = 1,
d1E 0 specializes to the metric of Rand (1971).
Between

these extremes, i.e., for E ⊆ E 0 ⊆ V2 , the metric dµE 0
can be used to analyze more specifically how two decompositions of the same graph differ. We propose an analysis
w.r.t. the distance δvw of nodes v and w in G, i.e., w.r.t. the
length of a shortest vw-path in G. For this, we denote by
δG := max{δvw : vw ∈ V2 } the diameter of G.
Definition 8 For any connected
 graph G = (V, E) and any
n ∈ N, let E[n] := {vw ∈ V2 | δvw = n} the set of pairs
of nodes of distance n in G. Moreover, let µn : E[n] → Q+
the constant function that maps any vw ∈ E[n] to 1/|E[n]|.
For any connected graph G = (V, E), we call the sequence


n

dµE[n]


n∈{1,...,δG }

(20)

the spectrum of pseudo-metrics on decompositions of G.
For E 0 := V2 and µ : E 0 → Q+ : vw 7→ 1/(δG |E[δvw ]|),
we call the metric dµE 0 the δ-metric on decompositions of G.
An example of a spectrum of pseudo-metrics is depicted in
Fig. 4. For any two decompositions Π, Π0 of a connected
graph G and suitable lifted multicuts x, x0 characterizing
n
these decompositions, dµE[n] (x, x0 ) equals the fraction of
pairs of nodes at distance n in G that are either cut by Π and
joined by Π0 , or cut by Π0 and joined by Π. I.e., the pseudon
metric dµE[n] compares decompositions of G specifically
w.r.t. the distance n in G. The δ-metric compares decompositions w.r.t. all distances, and each distance is weighted
equally. This is in contrast to Rand’s metric which is also a
comparison w.r.t. all distances but each distance is weighted
by the number of pairs of nodes that have this distance.

Fraction of pairs

Theorem 5 For any connected graph G = (V, E), any
graph G0 = (V, E 0 ), any µ : E 0 → R+ , the set E 00 :=
E ∪ E 0 and the graph G00 := (V, E 00 ), the function dµE 0 :
XGG00 × XGG00 → R+
0 of the form (19) is a pseudo-metric
on XGG00 . Iff G0 is a supergraph of G, i.e., iff E ⊆ E 0 , dµE 0
is a metric on XGG00 .

0.1

0.05

0
0

200 400 600 800
Distance

Figure 4. Depicted are two decompositions of the pixel grid graph
of an image, all from (Arbeláez et al., 2011), along with the spectrum of pseudo-metrics of these decompositions.

multicuts that characterize these decompositions. To compare partial lifted multicuts, we compare their partial characteristic functions by an extension of the Hamming metric:
For any E 6= ∅, any e ∈ E and any θ ∈ R+
0 , we define
dθe , dθE : {0, 1, ∗}E × {0, 1, ∗}E → R+
such
that for all
0
x̃, x̃0 ∈ {0, 1, ∗}E :

1 if e ∈ dom x̃ ∧ e ∈ dom x̃0 ∧ x̃e 6= x̃0e



0 if e ∈ dom x̃ ∧ e ∈ dom x̃0 ∧ x̃ = x̃0
e
e
dθe (x̃, x̃0 ) =
0

0
if
e
∈
/
dom
x̃
∧
e
∈
/
dom
x̃



θ otherwise
(21)
X
(22)
dθE (x̃, x̃0 ) =
dθe0 (x̃, x̃0 ) .
e0 ∈E

Theorem 6 For any connected graph G = (V, E), any
graph G0 = (V, E 0 ) with E ⊆ E 0 and any θ ∈ [ 21 , 1], the
function d˜θE 0 : X̃GG0 × X̃GG0 → R+
0 of the form
d˜θE 0 (x̃, x̃0 ) := dθE 0 (clGG0 x̃, clGG0 x̃0 )

(23)

is a pseudo-metric on X̃GG0 and a metric on X̂GG0 . Moreover, for any x̃, x̃0 ∈ X̃GG0 :
X̃GG0 [x̃] = X̃GG0 [x̃0 ] ⇔ d˜θE 0 (x̃, x̃0 ) = 0 .

(24)

By the one-to-one relation between decompositions and multicuts (Lemma 2), every partial characterization of a lifted
multicut x̃ ∈ X̃GG0 defines a class of decompositions of the
graph G, namely those defined by the lifted multicuts characterized by XGG0 [x̃]. By Theorem 6, d˜θE 0 with θ ∈ [ 12 , 1]
well-defines a metric on these classes of decompositions and
hence a means of comparing the classes of decompositions
definable by must-join and must-cut constraints. Computing
d˜θE 0 (x, x0 ) involves computing the closures of x and x0 and
is therefore NP-hard (by Theorem 4).

6. Polyhedral Optimization
5.2. Metrics on Classes of Decompositions
We compare classes of decompositions definable by mustjoin and must-cut constraints by comparing partial lifted

As a third and final application of lifted multicuts, we turn to
the optimization of graph decompositions by lifted multicuts
of minimum cost.

Analysis and Optimization of Graph Decompositions by Lifted Multicuts

a)

b)
e2

e1
G

−1

−1

3

G0

−1

−1

3

G0

Figure 5. Depicted above in (a) is an instance of the minimum
cost lifted multicut problem (Def. 9) w.r.t. graphs G, G0 and costs
c = (−1, −1, 3). Here, the cost 3 attributed to the additional edge
in G0 results in the edges e1 and e2 not being cut in the optimum
(0, 0, 0) which has cost 0. Depicted in (b) is an instance of the
minimum cost multicut problem w.r.t. the graph G0 and the same
cost function. Here, the cost 3 does not prevent the edges e1 and
e2 from being cut in the optimum (1, 1, 0) which has cost −2.

Definition 9 For any connected graph G = (V, E), any
graph G0 = (V, E 0 ) with E ⊆ E 0 and any c : E 0 → R,
the instance of the minimum cost lifted multicut problem
w.r.t. G, G0 and c is the optimization problem

(
)

X

min
ce xe  x ∈ XGG0
.
(25)

0
e∈E

If E 0 = E, (25) specializes to the minimum cost multicut
problem w.r.t. G0 and c that is also known as graph partition
or correlation clustering. If E 0 ⊃ E, the minimum cost
lifted multicut problem w.r.t. G, G0 and c differs from the
minimum cost multicut problem w.r.t. G0 and c. It has a
smaller feasible set XGG0 ⊂ XG0 , as we have shown in
Section 3 and depicted for the smallest example in Fig. 2
and 3. Unlike the minimum cost multicut problem w.r.t. G0
and c, the minimum cost lifted multicut problem w.r.t. G, G0
and c is such that any feasible solution x ∈ XGG0 indicates
by xvw = 0 that the nodes v and w are connected in G by a
path of edges labeled 0. See also Fig. 5. This property can be
used to penalize by cvw > 0 precisely those decompositions
of G for which v and w are in distinct components. For
nodes v and w that are not neighbors in G, such costs are
sometimes called non-local attractive.
To solve instances of the APX-hard minimum cost lifted
multicut problem by means of a branch-and-cut algorithm,
we study the geometry of lifted multicut polytopes.
Definition 10 (Deza & Laurent, 1997) For any graph G =
(V, E), the convex hull ΞG := conv XG of XG in RE is
called the multicut polytope of G.
Definition 11 For any connected graph G = (V, E) and
any graph G0 = (V, E 0 ) with E ⊆ E 0 , ΞGG0 :=
conv XGG0 is called the lifted multicut polytope w.r.t. G
and G0 .
Examples are shown in Fig. 2 and 3, respectively. In general,
the lifted multicut polytope ΞGG0 w.r.t. graphs G and G0
(Fig. 3) is a subset of the multicut polytope ΞG0 of the graph
G0 (Fig. 2). By Lemma 5, the system of cycle inequalities

(2) for G0 and cut inequalities (6) for G and G0 is redundant
as a description of XGG0 and thus of ΞGG0 . Below, we study
the geometry of ΞGG0 .
6.1. Dimension
Theorem 7 For any connected graph G = (V, E) and any
graph G0 = (V, E 0 ) with E ⊆ E 0 , dim ΞGG0 = |E 0 |.
We prove Theorem 7 by constructing |E 0 | + 1 multicuts of
G0 lifted from G whose characteristic functions are affine
independent points. The strategy is to construct, for any
e ∈ E 0 , an x ∈ XGG0 with xe = 0 and “as many ones as
possible”. The challenge is that edges cannot be labeled independently. In particular, for f ∈ FGG0 , xf = 0 can imply,
for certain f 0 ∈ FGG0 \ {f }, that xf 0 = 0, as illustrated in
Fig. 6. This structure is made explicit below, in Def. 12 and
13 and Lemmata 12 and 13.
Definition 12 For any connected graph G = (V, E) and
any graph G0 = (V, E 0 ) such that E ⊆ E 0 , the sequence
(Fn )n∈N of subsets of FGG0 defined below is called the
hierarchy of FGG0 with respect to G:
(a) F0 = ∅
(b) For any n ∈ N and any {v, w} = f ∈ FGG0 :
{v, w} ∈ Fn iff there exists a vw-path in G such that,
for any distinct nodes v 0 and w0 in the path such that
{v 0 , w0 } 6= {v, w}, either {v 0 , w0 } 6∈ FGG0 or there
exists a natural number j < n such that {v 0 , w0 } ∈ Fj .
Lemma 12 For any connected graph G = (V, E), any
graph G0 = (V, E 0 ) with E ⊆ E 0 and any f ∈ FGG0 , there
exists an n ∈ N such that f ∈ Fn .
Definition 13 For any connected graph G = (V, E) and
any graph G0 = (V, E 0 ) with E ⊆ E 0 , the map ` : FGG0 →
N such that ∀f ∈ FGG0 ∀n ∈ N : `(f ) = n ⇔ f ∈
Fn ∧ f 6∈ Fn−1 is called the level function of FGG0 .
Lemma 13 For any connected graph G = (V, E), any
graph G0 = (V, E 0 ) with E ⊆ E 0 and for any f ∈ FGG0 ,
there exists an x ∈ XGG0 , called f -feasible, such that
(a) xf = 0
(b) xf 0 = 1 for all f 0 ∈ FGG0 \ {f } with `(f 0 ) ≥ `(f ).
6.2. Facets
We characterize those edges e ∈ E 0 for which the inequality
xe ≤ 1 defines a facet of the lifted multicut polytope ΞGG0 .
Theorem 8 For any connected graph G = (V, E), any
graph G0 = (V, E 0 ) with E ⊆ E 0 and any e ∈ E 0 , the
inequality xe ≤ 1 defines a facet of ΞGG0 iff there is no
{v, w} = f ∈ FGG0 such that e connects a pair of v-w-cutvertices4 .
4
For any graph G = (V, E) and any v, w ∈ V , a v-w-cutvertex is a node u ∈ V that lies on every vw-path of G.

Analysis and Optimization of Graph Decompositions by Lifted Multicuts

a)

b)
f3
f1
v2

v6

f2
v2

v1

v1

v3

f1 f3

f2

v5

v4
v3

v4

Figure 6. If two nodes {v, w} = f ∈ FGG0 are in the same component, as indicated by xf = 0, this can imply xf 0 = 0 for one or
more f 0 ∈ F \ {f }. In (a) xf3 = 0 implies xf1 = 0 and xf2 = 0.
In (b) xf3 = 0 implies xf1 = 0 or xf2 = 0.

Next, we give conditions that contribute to identifying those
edges e ∈ E 0 for which the inequality 0 ≤ xe defines a
facet of the lifted multicut polytope ΞGG0 .
Theorem 9 For any connected graph G = (V, E), any
graph G0 = (V, E 0 ) with E ⊆ E 0 and any e ∈ E 0 , the
following assertions hold: In case e ∈ E, the inequality
0 ≤ xe defines a facet of ΞGG0 iff there is no triangle in G0
containing e. In case uv = e ∈ FGG0 , the inequality 0 ≤
xe defines a facet of ΞGG0 only if the following necessary
conditions hold:
(a) There is no triangle in G0 containing e.
(b) The distance of any pair of u-v-cut-vertices except
{u, v} is at least 3 in G0 .
(c) There is no triangle of nodes s, s0 , t in G0 such that
{s, s0 } is a u-v-separating node set and t is a u-v-cutvertex.
Next, we characterize those inequalities of (4) and (5) that
are facet-defining for ΞGG0 . Chopra & Rao (1993) have
shown that an inequality of (2) defines a facet of the multicut
polytope ΞG iff the cycle C is chordless. We establish a
similar characterization of those inequalities of (4) and (5)
that define a facet of the lifted multicut polytope ΞGG0 . For
clarity, we introduce some notation: For any cycle C of G
and any e ∈ C, let





X 

SGG0 (e, C) := x ∈ XGG0 xe =
x e0
(26)

 e0 ∈C\{e} 
ΣGG0 (e, C) := conv SGG0 (e, C) .

Inequalities defined by cycles in G0 that contain more than
one edge from the set FGG0 do not occur in (4) or (5). They
are valid for ΞGG0 as they are valid for ΞG0 ⊇ ΞGG0 . They
define a (non-trivial) facet of ΞGG0 only if the cycle is chordless (as chordal cycles are not even facet-defining for ΞG0 ).
At the same time, chordlessness is not a sufficient condition
for facet-definingness of non-trivial cycles. For example, in
Fig. 6a, the cycle inequality xf2 ≤ xf3 +xv1 v2 is dominated
by the (non-trivial) valid inequality xf2 ≤ xf3 .
Next, we consider the cut inequalities (6). Examples of cuts
that are not facet-defining for ΞGG0 are shown in Fig. 4
in the appendix. To constrain the class of cuts that are
facet-defining, we introduce additional notation: For any
connected graph G = (V, E), any distinct nodes v, w ∈ V
and any C ∈ vw-cuts(G), we denote by
G(v, C) = (V (v, C), E(v, C))

(30)

G(w, C) = (V (w, C), E(w, C))

(31)

the largest components of the graph (V, E \ C) that contain
v and w, respectively. By definition of a vw-cut5 , we have
V (v, C) ∩ V (w, C) = ∅

(32)

∧ V (v, C) ∪ V (w, C) = V .

(33)

We denote by FGG0 (vw, C) the set of those edges in FGG0 ,
except vw, that cross the vw-cut C of G, i.e.
FGG0 (vw, C) := {f ∈ FGG0 \ {vw} | f 6⊆ V (v, C) ∧
f 6⊆ V (w, C)} .

(34)

We denote by G0 (vw, C) := (V, FGG0 (vw, C) ∪ C) the
subgraph of G0 that comprises all edges from FGG0 (vw, C)
and C. Finally, we define

(
)

X

SGG0 (vw, C) := x ∈ XGG0 1 − xvw =
(1 − xe )

e∈C

(27)

For any vw = f ∈ FGG0 and any vw-path P in G, let

(
)

X

SGG0 (f, P ) := x ∈ XGG0 xvw =
xe
(28)

e∈P

ΣGG0 (f, P ) := conv SGG0 (f, P ) .

(a) For any cycle C in G and any e ∈ C, the polytope
ΣGG0 (e, C) is a facet of ΞGG0 iff C is chordless in G0 .
(b) For any edge vw = f ∈ FGG0 and any vw-path P
in G, the polytope ΣGG0 (f, P ) is a facet of ΞGG0 iff
P ∪ {f } is chordless in G0 .

(35)
ΣGG0 (vw, C) := conv SGG0 (vw, C) .

Definition 14 For any connected graph G = (V, E), any
distinct v, w ∈ V and any C ∈ vw-cuts(G), a component
(V ∗ , E ∗ ) of G is called properly (vw, C)-connected iff

(29)

Theorem 10 For any connected graph G = (V, E) and
any graph G0 = (V, E 0 ) with E ⊆ E 0 , the following assertions hold:

(36)

v ∈ V ∗ ∧ w ∈ V ∗ ∧ |E ∗ ∩ C| = 1 .
5

(37)

For any graph G = (V, E) and any distinct nodes v, w ∈ V ,
a vw-cut of G is a minimal (with respect to inclusion) set C ⊆ E
such that v and w are not connected in (V, E \ C).

Analysis and Optimization of Graph Decompositions by Lifted Multicuts

∗

∗

V ⊆ V (v, C) ∨ V ⊆ V (w, C) .

(38)

It is called (vw, C)-connected iff it is properly or improperly
(vw, C)-connected.
For any (vw, C)-connected component (V ∗ , E ∗ ) of G, we
denote by FV ∗ := {v 0 w0 = f 0 ∈ FGG0 (vw, C) | v 0 ∈ V ∗ ∧
w0 ∈ V ∗ } the set of those edges v 0 w0 = f 0 ∈ FGG0 (vw, C)
such that (V ∗ , E ∗ ) is also (v 0 w0 , C)-connected.
Theorem 11 For any connected graph G = (V, E), any
graph G0 = (V, E 0 ) with E ⊆ E 0 , any vw = f ∈ FGG0
and any C ∈ vw-cuts(G), ΣGG0 (vw, C) is a facet of ΞGG0
only if the following necessary conditions hold:
C1 For any e ∈ C, there exists a (vw, C)-connected component (V ∗ , E ∗ ) of G such that e ∈ E ∗ .
C2 For any ∅ 6= F ⊆ FGG0 (vw, C), there exists an edge
e ∈ C and (vw, C)-connected components (V ∗ , E ∗ )
and (V ∗∗ , E ∗∗ ) of G such that e ∈ E ∗ and e ∈ E ∗∗
and |F ∩ FV ∗ | =
6 |F ∩ FV ∗∗ |.
C3 For any f 0 ∈ FGG0 (vw, C), any ∅ =
6
F ⊆
FGG0 (vw, C) \ {f 0 } and any k ∈ N, there exist (vw, C)-connected components (V ∗ , E ∗ ) and
(V ∗∗ , E ∗∗ ) with f 0 ∈ FV ∗ and f 0 ∈
/ FV ∗∗ such that
|F ∩ FV ∗ | =
6 k or |F ∩ FV ∗∗ | =
6 0 .

(39)

C4 For any v 0 ∈ V (v, C), any w0 ∈ V (w, C) and any
v 0 w0 -path P = (VP , EP ) in G0 (vw, C), there exists a
properly (vw, C)-connected component (V ∗ , E ∗ ) of
G such that
(v 0 ∈
/ V ∗ ∨ ∃w00 ∈ VP ∩ V (w, C) : w00 ∈
/ V ∗)
∧

(w0 ∈
/ V ∗ ∨ ∃v 00 ∈ VP ∩ V (v, C) : v 00 ∈
/ V ∗) .
(40)

C5 For any cycle Y = (VY , EY ) in G0 (vw, C),
there exists a properly (vw, C)-connected component
(V ∗ , E ∗ ) of G such that
(∃v 0 ∈ VY ∩ V (v, C) : v 0 ∈
/ V ∗)
∧

(∃w0 ∈ VY ∩ V (w, C) : w0 ∈
/ V ∗) .

(41)

6.3. Algorithms
To study the relevance of geometric properties established
above, we compare two separation procedures, α and β,
for lifted multicut polytopes. We implement these for the
branch-and-cut algorithm in the software Gurobi. Our code
is available at https://github.com/bjoern-andres/graph. The

Objective Value

−100

It is called improperly (vw, C)-connected iff

α
β

−200
−300
−400
10−1

100

101

102
103
Time [s]

104

105

Figure 7. Compared above are the separation procedures α (black)
and β (green) in a branch-and-cut search for solutions of an instance of the minimum cost lifted multicut problem by Keuper
et al. (2015). Upper and lower bounds are depicted as thin and
thick lines, respectively.

procedure α is canonical and serves as a reference. It separates infeasible points by any of the inequalities (4)–(6).
Violated inequalities of (4) and (5) are found by searching
for shortest chordless paths. Violated inequalities of (5) are
found by searching for minimum vw-cuts. The procedure
β is less canonical: It separates infeasible points by some
cycle inequalities w.r.t. G0 (cf. Theorem 10) and by cut inequalities (6). Violated cycle inequalities of G0 are found by
first seaching for paths and cycles as before but then replacing sub-paths by chords in G0 . Violated cut-inequalities are
found as before but added to the problem only conditionally:
For each violated inequality of (6) that we find and the corresponding {v, w} ∈ FGG0 and C ∈ vw-cuts(G), we search
for a vw-path P in G0 such that one of the cycle inequalities for the cycle formed by P and {v, w} is violated. If it
exists, only the cycle inequality is added. Otherwise, the
cut-inequality is added. The advantage of β over α can be
seen in Fig. 7 for an instance of the min cost lifted multicut
problem by Keuper et al. (2015) with |V | = 126, |E| = 229
and |E 0 | = 1860.

7. Conclusion
By studying the set of all decompositions (clusterings) of
a graph through its characterization as a set of lifted multicuts, we have gained three insights: 1. Toward the definition
of classes of decompositions by must-join and must-cut
constraints, we have seen that consistency and maximal
specificity are NP-hard to decide. 2. Toward the comparison
of decompositions by metrics, we have defined a generalization of Rand’s metric and the boundary metric that enables
more detailed analyses of how two decompositions of the
same graph differ. This metric extends to classes of decompositions definable by must-join and must-cut constraints for
which it is NP-hard to compute. 3. Toward the optimization
of graph decompositions by minimum cost lifted multicuts,
we have established some properties of some facets of lifted
multicut polytopes. These properties have led us to efficient
separation procedures and a branch-and-cut algorithm for
the minimum cost lifted multicut problem.

Analysis and Optimization of Graph Decompositions by Lifted Multicuts

References
Arbeláez, Pablo, Maire, Michael, Fowlkes, Charless C., and
Malik, Jitendra. Contour detection and hierarchical image
segmentation. IEEE Transactions on Pattern Analysis
and Machine Intelligence, 33(5):898–916, 2011.
Bachrach, Yoram, Kohli, Pushmeet, Kolmogorov, Vladimir,
and Zadimoghaddam, Morteza. Optimal coalition structure generation in cooperative graph games. In AAAI,
2013.
Bansal, Nikhil, Blum, Avrim, and Chawla, Shuchi. Correlation clustering. Machine Learning, 56(1–3):89–113,
2004. doi: 10.1023/B:MACH.0000033116.57574.95.
Beier, Thorsten, Andres, Bjoern, Köthe, Ullrich, and Hamprecht, Fred A. An efficient fusion move algorithm for
the minimum cost lifted multicut problem. In ECCV,
2016. doi: 10.1007/978-3-319-46475-6 44.
Beier, Thorsten, Pape, Constantin, Rahaman, Nasim,
Prange, Timo, Berg, Stuart, Bock, Davi D., Cardona,
Albert, Knott, Graham W., Plaza, Stephen M., Scheffer,
Louis K., Koethe, Ullrich, Kreshuk, Anna, and Hamprecht, Fred A. Multicut brings automated neurite segmentation closer to human performance. Nature Methods,
14(2):101–102, 2017. doi: 10.1038/nmeth.4151.
Chopra, Sunil and Rao, M.R. The partition problem. Mathematical Programming, 59(1–3):87–115, 1993. doi:
10.1007/BF01581239.
Chopra, Sunil and Rao, M.R. Facets of the k-partition
polytope. Discrete Applied Mathematics, 61(1):27–48,
1995. doi: 10.1016/0166-218X(93)E0175-X.

Grötschel, Martin and Wakabayashi, Yoshiko. A cutting
plane algorithm for a clustering problem. Mathematical Programming, 45(1):59–96, 1989. doi: 10.1007/
BF01589097.
Kappes, Jörg Hendrik, Speth, Markus, Reinelt, Gerhard,
and Schnörr, Christoph. Higher-order segmentation via
multicuts. Computer Vision and Image Understanding,
143(C):104–119, 2016. doi: 10.1016/j.cviu.2015.11.005.
Keuper, Margret, Levinkov, Evgeny, Bonneel, Nicolas,
Lavoué, Guillaume, Brox, Thomas, and Andres, Bjoern. Efficient decomposition of image and mesh graphs
by lifted multicuts. In ICCV, 2015. doi: 10.1109/ICCV.
2015.204.
Kim, Sungwoong, Yoo, Chang D., Nowozin, Sebastian, and
Kohli, Pushmeet. Image segmentation using higher-order
correlation clustering. IEEE Transactions on Pattern
Analysis and Machine Intelligence, 36(9):1761–1774,
2014. doi: 10.1109/TPAMI.2014.2303095.
Klein, Philip N., Mathieu, Claire, and Zhou, Hang. Correlation clustering and two-edge-connected augmentation
for planar graphs. In Symposium on Theoretical Aspects
of Computer Science, 2015. doi: 10.4230/LIPIcs.STACS.
2015.554.
Levinkov, Evgeny, Uhrig, Jonas, Tang, Siyu, Omran, Mohamed, Insafutdinov, Eldar, Kirillov, Alexander, Rother,
Carsten, Brox, Thomas, Schiele, Bernt, and Andres, Bjoern. Joint graph decomposition and node labeling by local
search. In CVPR, 2017. (Forthcoming).

Davidson, Ian and Ravi, S. S. Intractability and clustering
with constraints. In ICML, 2007. doi: 10.1145/1273496.
1273522.

Meilă, Marina. Comparing clusteringsan information based
distance. Journal of Multivariate Analysis, 98(5):873–
895, 2007. doi: 10.1016/j.jmva.2006.11.013.

Demaine, Erik D., Emanuel, Dotan, Fiat, Amos, and Immorlica, Nicole. Correlation clustering in general weighted
graphs. Theoretical Computer Science, 361(2–3):172–
187, 2006. doi: 10.1016/j.tcs.2006.05.008.

Nowozin, Sebastian and Jegelka, Stefanie. Solution stability
in linear programming relaxations: Graph partitioning
and unsupervised learning. In ICML, 2009.

Deza, Michel Marie and Laurent, Monique. Geometry of
Cuts and Metrics. Springer, 1997.

Nowozin, Sebastian and Lampert, Christoph H. Global interactions in random field models: A potential function
ensuring connectedness. SIAM Journal on Imaging Sciences, 3(4):1048–1074, 2010. doi: 10.1137/090752614.

Deza, Michel Marie, Grötschel, Martin, and Laurent,
Monique. Complete descriptions of small multicut polytopes. In Applied Geometry and Discrete Mathematics
– The Victor Klee Festschrift, volume 4 of DIMACS Series in Discrete Mathematics and Theoretical Computer
Science, pp. 221–252, 1991.
Deza, Michel Marie, Grötschel, Martin, and Laurent,
Monique. Clique-web facets for multicut polytopes.
Mathematics of Operations Research, 17(4):981–1000,
1992. doi: 10.1287/moor.17.4.981.

Rand, William M. Objective criteria for the evaluation of
clustering methods. Journal of the American Statistical Association, 66(336):846–850, 1971. doi: 10.1080/
01621459.1971.10482356.
Tang, Siyu, Andriluka, Mykhaylo, Andres, Bjoern, and
Schiele, Bernt. Multiple people tracking by lifted multicut and person re-identification. In CVPR, 2017. (Forthcoming).

Analysis and Optimization of Graph Decompositions by Lifted Multicuts

Voice, Thomas, Polukarov, Maria, and Jennings, Nicholas R.
Coalition structure generation over graphs. Journal of
Artificial Intelligence Research, 45(1):165–196, 2012.
Yarkony, Julian, Ihler, Alexander, and Fowlkes, Charless C.
Fast planar correlation clustering for image segmentation.
In ECCV, 2012.

