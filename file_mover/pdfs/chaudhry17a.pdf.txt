Uncertainty Assessment and False Discovery Rate Control
in High-Dimensional Granger Causal Inference
Aditya Chaudhry 1 Pan Xu 2 Quanquan Gu 2

Abstract
Causal inference among high-dimensional time
series data proves an important research problem
in many fields. While in the classical regime one
often establishes causality among time series via
a concept known as “Granger causality,” existing approaches for Granger causal inference in
high-dimensional data lack the means to characterize the uncertainty associated with Granger
causality estimates (e.g., p-values and confidence
intervals). We make two contributions in this
work. First, we introduce a novel asymptotically
unbiased Granger causality estimator with corresponding test statistics and confidence intervals to
allow, for the first time, uncertainty characterization in high-dimensional Granger causal inference.
Second, we introduce a novel method for false discovery rate control that achieves higher power in
multiple testing than existing techniques and that
can cope with dependent test statistics and dependent observations. We corroborate our theoretical
results with experiments on both synthetic data
and real-world climatological data.

In statistics, causality is often established by means of a controlled, randomized experiment. Nevertheless, controlled,
randomized experiments are often infeasible, leaving researchers with only access to observational data. This situation arises routinely when working with time series data.
Areas that must cope with this obstacle frequently include
genetics (Shojaie & Michailidis, 2010) and neuroscience
(Seth et al., 2015). The natural question that arises is: how
can one determine which factors cause changes in a certain response variable using only data in which all variables
change simultaneously? Causal inference seeks to address
this problem.
The classic method for causal inference among time series is a concept from econometrics known as Granger
causality, named after Nobel Prize winning econometrician
Clive Granger (Granger, 1969). Granger causality formalizes the intuitive notion that in a causal system, the cause
must precede the effect, and the cause must hold some
unique information that helps predict the effect. For example, let X1 , . . . , XT and Y1 , . . . , YT be two stationary
one-dimensional time series. We can model time series Y
using the following auto-regressive model (Stock & Watson,
2011):
Yt =

1 Introduction
The advent of “big data” in recent years has generated countless opportunities for the prediction of real world phenomena with unprecedented accuracy and at unprecedented scale.
Statistical methods for prediction exploit associations in existing data to predict some response variable. However, the
task at hand is often not to predict the response variable from
pre-existing data, but rather to determine how a change in
one or more of the explanatory variables will cause changes
in the response variable.
1

Department of Mathematics, University of Virginia, Charlottesville, VA 22904, USA 2 Department of Computer Science,
University of Virginia, Charlottesville, VA 22904, USA. Correspondence to: Quanquan Gu <qg5w@virginia.edu>.
Proceedings of the 34 th International Conference on Machine
Learning, Sydney, Australia, PMLR 70, 2017. Copyright 2017 by
the author(s).

p
X

ai Yt

i

(1.1)

+ ✏t ,

i=1

where a1 , . . . , ap are the coefficient parameters for the regression, p < T is the maximal lag of the model, and ✏t is
the error term. To determine whether or not X is a Granger
cause of Y , we also form a second auto-regressive model:
Yt =

p
X
i=1

bi Y t

i

+

p
X

c i Xt

i

+ !t ,

(1.2)

i=1

with coefficient parameters b1 , . . . , bp , c1 , . . . , cp , and error
term !t . In this classical regime, where the number of
observations exceeds the number of variables (T p > 2p),
one can fit both of these models with ordinary least squares
(OLS). We can conduct an F-test between models (1.1) and
(1.2) as well as hypothesis tests on coefficients ci , 1  i 
p, to determine if the extra information encompassed by
previous values of X significantly aides in the prediction of

Uncertainty Assessment and False Discovery Rate Control in High-Dimensional Granger Causal Inference

future values of Y . If this pair of models passes the F-test
and at least one of the coefficient hypothesis tests at some
significance level ↵, then we may reject the null hypothesis
that X is not a Granger cause of Y (Granger, 1969).
Although the concept of Granger causality has existed for
decades, Granger (1969) only rigorously treated the bivariate case. However, as noted by Arnold et al. (2007), Eichler
(2006) provided one framework for multivariate analysis by
applying graphical models to Granger causal inference.
Multivariate Granger causal inference relies on hypothesis
testing of model coefficients in a fitted vector-autoregressive
(VAR) model (Lutkepohl, 2007). VAR models are fit with
OLS. In the high-dimensional regime, where the number of
parameters exceeds the number of observations (T p < pd,
where d is the number of time series in the VAR model),
OLS estimation is impossible. Hence, one must employ
regularized regression methods. Perhaps the most wellknown such method is the Lasso (Tibshirani, 1996), which
encourages sparsity in the coefficient parameter vector via
an `1 penalty. To conduct Granger causal inference in the
high-dimensional regime, Arnold et al. (2007) proposed the
“Lasso Granger” estimator, which we fully specify in (3.3).
Unfortunately, since the limiting distribution of the underlying Lasso estimator is not normal (Knight & Fu, 2000) and
intractable in general (Javanmard & Montanari, 2014), one
cannot construct confidence intervals or compute test statistics for hypothesis tests of Lasso Granger coefficient point
estimates. Thus, existing methods for high-dimensional
Granger causal inference do not allow for the assessment
of uncertainty. Uncertainty characterization proves an important, and often necessary, element of research in the
natural sciences. Therefore, uncertainty assessment techniques would augment the versatility of high-dimensional
Granger causal inference methods, and drive their wider
adoption by the scientific community.
Another issue in high-dimensional causal inference is how
to limit the number of false positives generated when testing
a large number of explanatory variables without sacrificing
identification of the true causal effects. That is, the researcher wants to attain high power while still maintaining a
low type I error rate. To this end, false discovery rate (FDR)
control (Benjamini & Hochberg, 1995) proves an important
part of any method for high-dimensional causal inference.
Unfortunately, existing FDR control methods cannot cope
with the two challenges posed by our setting: dependent test
statistics and dependent observations. These methods thus
prove unsuitable in many practical applications.
In this paper, we make two contributions. First, we propose a novel asymptotically unbiased estimator for highdimensional Granger causal inference inspired by Javanmard & Montanari (2014). We leverage this estimator’s
unbiasedness to construct confidence intervals and p-values

for coefficient point estimates. In this way, we allow, for the
first time, uncertainty characterization in high-dimensional
Granger causal inference. Second, we propose a novel FDR
control technique that can cope with dependent test-statistics
and dependent observations. In addition to surmounting
these theoretical obstacles to existing methods, our FDR
control technique also achieves higher power in multiple
testing than existing methods. Additionally, the proof techniques we use to extend high-dimensional results from the
independent and identically distributed (i.i.d.) setting to our
time series setting are of independent interest. Specifically,
to establish the asymptotic unbiasedness and normality of
our estimator, we appeal to Talagrand’s generic chaining
(Talagrand, 2006) and martingale theory. We further employ
martingale theory, along with empirical process theory, to
prove the asymptotic validity of our FDR control procedure.
The rest of this paper is organized as follows. Section 2
contextualizes our contributions in the existing literature.
Section 3 sets up the problem of high-dimensional Granger
causal inference. Section 4 presents our novel de-biased estimator and FDR control procedure. Section 5 establishes our
main theoretical results, which we corroborate empirically
in Section 6. Section 7 concludes the paper.

2

Related Work

As mentioned above, Clive Granger examined bivariate
Granger causality in 1969 (Granger, 1969). Advances in
the area of graphical models provided a strong framework
for multivariate causal inference in general (Pearl, 2009).
Graphical models were first applied specifically to Granger
causal inference by Eichler (2001) and Eichler (2006), and
have provided a foundation for more complex models.
However, these methods rely on OLS estimation, which is
impossible in the high-dimensional regime. Meinshausen &
Bühlmann (2006) applied Lasso to the estimation of highdimensional graphical models. Arnold et al. (2007) then
applied the method proposed by Meinshausen & Bühlmann
(2006) to multivariate Granger causal inference, and introduced the estimator of primary interest for this work: the
Lasso Granger estimator. The Lasso Granger estimator
yields a coefficient vector in which non-zero coefficients
indicate conditional Granger causes of the response variable.
Classical methods for uncertainty analysis prove impossible
for the Lasso Granger estimator. Recent work (Lee et al.,
2013; Lockhart et al., 2014; Taylor et al., 2014) in the area
of high-dimensional inference has made great strides toward
addressing this issue. Early work focussed on constructing pvalues and confidence intervals for Lasso coefficients via the
bootstrap (Chatterjee et al., 2013; Liu et al., 2013a). However, later work found that these methods perform poorly
compared to more recent methods (Dezeure et al., 2015),
especially in non-i.i.d. settings (Karoui & Purdom, 2016).

Uncertainty Assessment and False Discovery Rate Control in High-Dimensional Granger Causal Inference

Perhaps the most promising work in high-dimensional inference has emerged from the perspective of bias correction
(Bühlmann et al., 2013; Zhang & Zhang, 2014). Subsequent work by Van de Geer et al. (2014) and Javanmard
& Montanari (2014) introduced a method to de-bias the
Lasso solution to yield asymptotically valid confidence intervals and hypothesis tests for coefficient point estimates.
Nevertheless, these existing methods assume that the observations forming the design matrix are independent, and
so cannot tackle causal inference among time series. Our
method applies the Lasso de-biasing technique to the original Lasso Granger estimator. We overcome the inability
of existing methods to cope with non-i.i.d. data by using
Talagrand’s generic chaining (Talagrand, 2006) and the martingale technique to derive the asymptotic distribution of
our novel de-biased Lasso Granger estimator.
Hypothesis testing in the high-dimensional setting raises the
need for procedures to address the multiple testing problem.
FDR control is one such way to control type I error in multiple testing. Our setting poses two challenges to existing
FDR control procedures. First, the most-widely used methods, such as the Benjamini-Hochberg procedure (Benjamini
& Hochberg, 1995), assume the test statistics under consideration are independent. While Benjamini & Yekutieli (2001)
proposed a slight variation on the Benjamini-Hochberg procedure that could control FDR under “positive regression
dependency” (e.g., when the covariance matrix of the explanatory variables is strictly positive), in our setting where
the explanatory variables interact in complex ways, the test
statistics will not satisfy this property. This version of the
Benjamini-Hochberg procedure achieves only low power
in the presence of a general dependence structure (Romano
et al., 2008), and is thus unsuitable for our setting. Recent
methods from the area of graphical models, which explicitly model the dependency of explanatory variables, have
made progress in addressing the case of dependent test statistics (Xie et al., 2011; Liu et al., 2013b). However, these
methods still encounter the second challenge of our setting:
dependent observations arising from time series data. To
control FDR for dependent observations, one must resort to
assumption-free methods, such as the Bonferroni technique,
that achieve low power in practice. We propose a FDR control procedure that can cope with dependent test statistics
and observations, and that achieves high power.
Notation We denote matrix A = [Ai,j ] 2 Rm⇥n and column vector v = [vi ] 2 RT . We write the `p norm of vector
p
v as kvkp = ⌃i=T
i=1 |vi | . Furthermore, kvk1 denotes the
max-norm of vector v: kvk1 = max1iT |vi |. Additionally, kvk0 = supp(v) designates the cardinality of the
support (the set of all non-zero entries) of v. We represent
the the max-norm of matrix A as kAk1 = maxi,j |Ai,j |.
The minimum and maximum singular values of A are denoted by min (A) and max (A), respectively. (x) ⌘

p
Rx
2
(1/ 2⇡) 1 e t /2 dt refers to the cumulative distribution function of the standard normal distribution. For a
random variable X and a sequence of random variables
P
Xn , we write Xn ! X if Xn converges in probability
D
to X, and Xn ! X if Xn converges in distribution to
X. For sequences of random variables Xn and Yn , we say
Xn ⇣ Yn if Xn has the “same asymptotic order” as Yn , that
is, if both sequences bound each other up to some universal
multiplicative constant.

3

Granger Causality and its Estimator

In this section, we set up the problem of high dimensional
Granger causal inference. Denote the design matrix X, the
number of parameters d, the number of observations T ,
and the maximal lag p. For a given design matrix X =
b =
[Xt,j ] 2 RT ⇥d define the sample covariance matrix ⌃
>
d⇥d
X X/T 2 R
. The j-th column of X represents time
series Xj , 1  j  d. We can further denote lagged
ft,j =
versions of each column in the design matrix with X
>
p
(Xt p,j , Xt p+1,j , . . . , Xt 1,j ) 2 R . Note that Xt 1,j
represents the observation immediately before Xt,j in time
series Xj . In Granger causal analysis, the response variable
is one of the explanatory variables. Hence, we can model an
arbitrary variable Xt,j , with 1  j  d and p + 1  t  T ,
by using the lagged values of all explanatory variables as
predictors:
Xt,j =

d
X
i=1

ft,i + ✏t,j .
✓ij⇤> X

(3.1)

Here ✓ij⇤ 2 Rp and ✏t,j ⇠ N (0, j2 ). Time series Xi
is a conditional Granger cause of time series Xj (conditioned on the other d - 2 time series) if ✓ij⇤ contains
any non-zero elements (i.e., k✓ij⇤ k0 > 0). We can vecft,i , for 1  i  d,
torize the sets of all ✓ij⇤ and all X
j⇤>
j⇤>
j⇤>
ft =
as ✓ j⇤ = (✓1 , ✓2 , . . . , ✓d )> 2 Rpd and X
> f>
> >
pd
f
f
(Xt,1 , Xt,2 , . . . , Xt,d ) 2 R , respectively. Based on
(3.1), the Lasso Granger estimator (Arnold et al., 2007) is
given by
✓bj = arg min
j
✓

where

T
X

1
2(T

p) t=p+1

ft )2 + k✓ j k1 ,
✓ j> X

(Xt,j

> 0 is the regularization parameter.

e = (X
fp+1 , X
fp+2 , . . . , X
fT )> 2
Equivalently, letting X
R(T p)⇥pd and Yj = Xp+1:T,j represent the lower T p
elements of the j-th column of X , we can re-express our
model in more standard notation as:

where ✏ ⇠ N (0,

2

e j⇤ + ✏,
Yj = X✓

I(T

p)⇥(T

p) ).

(3.2)

We can now re-express

Uncertainty Assessment and False Discovery Rate Control in High-Dimensional Granger Causal Inference

the Lasso Granger estimator as:
✓bj = arg min
j
✓

1
2(T

p)

kYj

e j k2 + k✓ j k1 . (3.3)
X✓
2

For ease of presentation, we will henceforth omit the identifying variable j from ✓ j⇤ , ✓bj , and Yj , and assume we are
referring to some arbitrary response variable. Using the
above notation, we can now denote the sample covariance
e as ⌃
en = X
e > X/(T
e
matrix of X
p) 2 Rpd⇥pd and the
e
e
true covariance matrix as ⌃ = E[⌃n ].

4 Asymptotic Inference for Lasso Granger

In this section, we introduce our de-biased Lasso Granger
estimator, and construct confidence intervals and p-values
for its elements. We will then present our method for false
discovery rate control in multiple testing.
4.1 Confidence Intervals and Hypothesis Tests
In deriving a de-biased version of the Lasso Granger estimator, we employ a variation of the Lasso de-biasing procedure
proposed by Javanmard & Montanari (2014). In particular, we define the de-biased Lasso Granger estimator ✓bu as
follows:
✓bu = ✓b +

1

T

p

e > (Y
MX

b
e ✓),
X

(4.1)

where ✓b 2 Rpd is the parameter vector yielded when computing the Lasso Granger estimator (3.3) for an arbitrary
>
response variable Y = Yj . M = (m1 , m2 , . . . , mpd ) 2
e 1 , the inverse sample covariRpd⇥pd is an estimate of ⌃
n
e
ance matrix of X, where each mi is the solution to the
following optimization algorithm:
e nm
minimize m> ⌃

e nm
subject to k⌃

ei k1  µ,
(4.2)

where ei 2 Rpd is the i-th column of Ipd⇥pd , and the choice
of µ will be clear after we deliver theory. Our unbiased estimator ✓bu , though inspired by Javanmard & Montanari
(2014), diverges sharply from their work in several respects.
While Javanmard and Montanari use the observed design
matrix X in their estimator, we use the transformed design
e Although in our time series setting the rows
matrix X.
of design matrix X are already dependent, transforming
e exacerbates this dependency and renders the i.i.d.
X to X
results underpinning Javanmard and Montanari’s work unusable. Hence, we appeal to Talagrand’s generic chaining
(Talagrand, 2006) and martingale theory to establish our
theoretical results about ✓bu .
Theorem 5.5 in Section 5 below proves that for any i 2
{1, 2, . . . , pd}, the standardized estimate of the i-th element

of ✓bu converges in distribution to the standard normal distribution:
p

T

✓biu ✓i⇤
D
! N (0, 1).
e n M> ]1/2
[M⌃

p

(4.3)

i,i

Unfortunately, the true noise level, denoted here by , is
unknown in most real-world applications. Hence, we replace with a consistent estimator, denoted b, yielded by
the Scaled Lasso (Sun & Zhang, 2012):
b ), b( )} =
{✓(
⇢
1
argmin
kY
2
(T
P)
pd
✓2R , >0

e 2+
X✓k
2

2

+ k✓k1 ,
(4.4)

where is the regularization parameter. Sun & Zhang (2012)
prove b is a consistent estimator of when the penalized
loss function is convex. Sun & Zhang (2012) use the i.i.d
assumption to establish convexity. In our non-i.i.d. setting,
we establish convexity via a restricted eigenvalue condition
for martingale difference sequences. Thus, b is consistent in
our setting as well. Then by the Slutsky Theorem (Van der
Vaart, 2000), we can replace in (4.3) with b.

One can easily apply (4.3) to construct confidence intervals
for ✓i⇤ , for 1  i  pd. If the significance level is ↵ > 0,
the 1 ↵ confidence interval for ✓i⇤ is:
Ii = [✓biu

(↵, T

where

(↵, T

p) =

1

(1

p), ✓biu + (↵, T

p
↵/2)(b/ T

p)],

(4.5)
1/2

e n M> ] .
p)[M⌃
i,i

We prove the asymptotic validity of this confidence interval
in Corollary 5.6.

Similarly, we can also conduct hypothesis tests on the individual regression coefficients ✓i⇤ , for 1  i  pd. In the
context of Granger causality, the relevant null and alternative
hypotheses are H0i : ✓i⇤ = 0 and Hai : ✓i⇤ 6= 0, respectively.
Having zero-coefficients for all variables p(x 1) < i  px
implies that time series 1  x  d is not a conditional
Granger cause of the response time series. Conversely, rejecting H0i for any variable p(x 1) < i  px amounts
to rejecting the null hypothesis that time series x is not a
Granger cause of the response time series. We thus consider
the following test statistic for H0i : ✓i⇤ = 0:
bu pT p
✓
i
ci =
Z
.
(4.6)
e n M> ]1/2
b[M⌃
i,i
D

ci ! N (0, 1) by (4.3).
Note that under the null hypothesis Z
The hypothesis test at significance level ↵ is thus given by
Z (↵)

ci | < z↵/2 ),
= 1( |Z

(4.7)

Uncertainty Assessment and False Discovery Rate Control in High-Dimensional Granger Causal Inference

where z↵/2 is the quantile of the standard normal distribution such that (z↵/2 ) = ↵/2. We reject the null hypothesis
if and only if Z (↵) = 1. The p-value for this hypothesis
test is
ci |)).
(|Z

Pi = 2(1

(4.8)

As usual, one would reject H0i at a pre-specified significance
level ↵ if Pi < ↵. We establish that the type I error of the hypothesis test Z (↵) converges to the specified significance
level, and that the p-value Pi is asymptotically uniformly
distributed in Corollary 5.7.

Definition 5.1. (Vershynin, 2012) A random variable X is
sub-Gaussian if there exists a constant C > 0 such that
P(|X| > t)  2 exp[ t2 /C 2 ],
for all t > 0.
A random vector X 2 Rn is sub-Gaussian if the onedimensional marginals < X, v > are sub-Gaussian random
variables for all v 2 Rn .
Definition 5.2. (Javanmard & Montanari, 2014) The subGaussian norm of a random scalar variable X is:

4.2 False Discovery Rate Control
Having established test statistics for individual coefficients
of the de-biased Lasso Granger estimator, we now address
the issue of FDR control. First, denote the set of coefficient
indices i such that ✓i⇤ = 0 as H0 = {i|✓i⇤ = 0, 1  i  pd}.
Define the complement of this set as H1 = {i|✓i⇤ 6= 0, 1 
i  pd}. We define FDR and false discovery proportion
(FDP) as follows:
P
c
⌫)
i2H0 1(|Zi |
FDP(⌫) =
,
P
c
max{
1(|Zi | ⌫), 1}
1jpd

FDR(⌫) = E[FDP(⌫)].

When conducting hypothesis tests at significance 0 < ↵ <
1, we seek the smallest ⌫ such that FDR(⌫)  ↵. In this
way, we will be able to reject the null hypothesis as often as
possible (i.e., we maximize power) while still guaranteeing
that our type I error rate does not exceed ↵. Thus, the ideal
choice of ⌫ is
P
⇢
c
⌫}
i2H0 1{|Zi |
⌫b = inf ⌫ > 0 :
↵ .
P
cj | ⌫}, 1}
max{ 1jpd 1{|Z
(4.9)

Note that the left hand side of the inequality in (4.9) is
FDP, whose expectation is FDR. Unfortunately, ⌫b cannot be
computed under the unknown H0 (Liu et al., 2013b). However, following Liu & Luo (2014), we use the asymptotic
ci under the null hypothesis to approximate
normality of Z
P
c
⌫} by 2(1
(⌫))pd. In multiple hypothi2H0 1{|Zi |
esis testing, we use ⌫b as the threshold for rejecting the null
hypothesis, instead of z↵/2 , in hypothesis test Z (↵) (4.7).
Theorem 5.9 below demonstrates the asymptotic validity of
this FDR control method.

5 Main Theory
In this section we present our main theoretical results: the
ci from (4.6) converges in distribution to the
test statistic Z
standard normal under the null hypothesis, and the FDR
control procedure presented in (4.9) asymptotically controls
both FDR and FDP. To begin, we present several definitions.

kXk

2

= sup q

1/2

(E[|X|q ])1/q .

q 1

The sub-Gaussian norm of a random vector X 2 Rn is:
kXk
where S n

1

2

= sup khX, uik 2 ,
u2S n

1

is the unit sphere in Rn space.

Having established these definitions, we impose two assumptions on the design matrix and the true covariance
matrix of the design matrix.
Assumption 5.3. There exist universal constants
e
Cmin , Cmax such that 0 < Cmin 
min (⌃) 
e
max (⌃)  Cmax .
e are sub-Gaussian and the
Assumption 5.4. The rows of X
sub-Gaussian norm of each row is bounded by some confi k  , for i 2 {1, 2, . . . , T p}.
stant  so that kX
2

We use Assumption 5.3 to demonstrate that the restricted
e n in order to prove the
eigenvalue condition holds for ⌃
u
asymptotic unbiasedness of ✓b . Assumption 5.4 plays a role
at multiple stages of the proof of Theorem 5.5, including
e n and esproving the restricted eigenvalue condition for ⌃
tablishing a high-probability bound for the regularization
parameter . Both of these assumptions prove common in
the high-dimensional inference literature.
We leverage Assumptions 5.3 and 5.4 to present the following theorem.
Theorem 5.5. Suppose Assumptions
p 5.3 and 5.4 are satisfied.p Let s0 = supp(✓ ⇤ ) ⇣
T p/ log(pd) and
µ ⇣ log(pd)/(T p). Then for any element ✓biu of the
de-biased Lasso Granger estimator ✓bu defined in (4.1), we
have
p

T

p

✓biu ✓i⇤
D
! N (0, 1).
e n M> ]1/2
[M⌃
i,i

Theorem 5.5 immediately yields several useful results. We
first demonstrate the asymptotic validity of confidence interval (4.5) for any element of ✓bu in the following corollary.

Uncertainty Assessment and False Discovery Rate Control in High-Dimensional Granger Causal Inference

Corollary 5.6. Denote significance level ↵ > 0, and
for 1  i  pd, define interval Ii = [✓biu
(↵, T
p) = (1
p), ✓biu + (↵, T
p)]. Here, (↵, T
p
e n M> ]1/2 . Then
↵/2)( / T p)[M⌃
i,i
T

lim

p!1

P(✓i⇤ 2 Ii ) = 1

↵.

By Corollary 5.6, the asymptotic coverage probability corresponds the the given confidence level. Note that we can
replace with b by the Slutsky Theorem. Similarly, we
confirm in the following corollary that the type I error for hypothesis test Z (↵), introduced in (4.7), matches the given
significance level ↵. Furthermore, we prove that the CDF
of the p-value Pi for Z (↵), which we introduced in (4.8),
converges in distribution to a uniform distribution.
Corollary 5.7. With Z (↵) and Pi defined as above, and
significance level ↵ > 0, we have:
P(

i
Z (↵) = 1|H0 )

(T

p)!1

!↵

and

ci are
Unfortunately, in this application, the test statistics Z
correlated, rendering the convergence in (5.1) non-trivial.
In order to prove (5.1), we will leverage martingale theory,
empirical process theory, and the following assumption.

Assumption 5.8. For constant c > 2,
s
◆
X ✓ |✓i⇤ |
c log(pd)
1
! 1,
e 1/2
(T p)
⌃
as (T

i,i

p, pd) ! 1.

Assumption 5.8 implies that the number of true alternative
hypotheses approaches infinity. This property proves important because, as demonstrated by Liu et al. (2014), FDR
control is impossible when the number of true alternative
hypotheses is fixed. This assumption allows us to present
the following theorem:
Theorem
5.9. Assume pd  (T
p)r and log(pd) =
p
o( T p) for some r > 0. Furthermore, suppose that
Assumption 5.8 and the assumptions of Theorem 5.5 hold.
Then at significance level ↵,

(T

as (T

lim

p,pd)

FDR(b
⌫)
FDP(b
⌫) P
= 1 and
! 1,
↵|H0 |/(pd)
↵|H0 |/(pd)

p, pd) ! 1.

6

Numerical Experiments

In this section, we establish the effectiveness of our debiased Lasso Granger estimator and our FDR control procedure via experimental results. We also demonstrate that our
methods outperform existing techniques.
6.1

Synthetic Data

Table 1: Empirical type I errors when testing H0 : ✓i⇤ = 0
over 500 simulations for ↵ = .05 for “random” and “cluster”
transition matrix patterns.
T

d

p

Random

Cluster

150
150
250
250

200
200
300
300

1
2
1
2

.046
.054
.050
.046

.052
.054
.040
.046

D

Pi ! U [0, 1].

We now turn our attention to demonstrating the asymptotic
validity of the FDR control method we present in Section
4.2. To control FDR we desire the following property:
P
c
⌫b) P
i2H0 1(|Zi |
! 1.
(5.1)
2|H0 |(1
(b
⌫ ))

i2H1

Theorem 5.9 establishes that the FDR control procedure we
present in Section 4.2 asymptotically controls both FDR
and FDP. Note that the upper bound rate imposed on pd is
very mild and will pose no issues in the vast majority of
applications. The assumptions of Theorem 5.5 guarantee
ci .
the asymptotic normality of test statistic Z

In this section, we corroborate our theoretical results and
compare our contributions to existing methods with numerical experiments on synthetic data. The data for these experiments are generated by model (3.1). In order to satisfy
the assumptions of Theorem 5.5, each ✓ j⇤ is a sparse vector
such
p that the probability of each element being non-zero
is T p/(2pd log(pd)) for 1  j  d. We use the R
package“flare” (Li et al., 2012) to generate sparse transition
matrices, and the “glmnet” package (Friedman et al., 2010)
to compute the biased Lasso Granger estimate. We examine
multiple different transition matrix patterns (“random” and
“cluster”, as generated by the “flare” package) and multiple
different configurations of (T, d, p).
In Table 1, we see that the empirical type 1 error of hypothesis test Z (↵) (4.7) corresponds to the given significance
level across multiple configurations of (T, d, p). Figure
1(a) corroborates Theorem 5.5 by demonstrating that the
ci under the null hyempirical distribution of test statistic Z
pothesis is the standard normal distribution. Figure 1(a)
also illustrates that coefficient point estimates for the biased
Lasso Granger estimator do not follow the standard normal
distribution. Figure 1(b) validates Corollary 5.7 by demonstrating that the empirical CDF of p-value (4.8) for a true
zero parameter is the uniform distribution. Furthermore,
Figures 1(c) and 1(d) exhibit that hypothesis test Z (↵)
(4.7) attains higher power than the biased Lasso Granger estimator when testing a single true non-zero parameter. Table
2 demonstrates the accuracy of the de-biased Lasso Granger
estimator via computations of the `1 and `2 norms of the

−3

−2

−1

0

1

2

3

0.0

0.2

0.4

0.6

0.8

1.0
0.2

0.4

Power

0.6

0.8

1.0
0.8
0.6

Power

De−biased LG
Biased LG

1.0

0.0

0.2

Quantiles of Standard Normal Distribution

(a) Q-Q Plot

De−biased LG
Biased LG
0.0

●

0.4

0.8
0.6

●
●●●
●

0.0

●

0.2

De−biased LG
Biased LG

●

−3

●

0.4

2
1
0
−1

●

−2

Sample Quantiles of Test Statistic

●

●●
●●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●●
●
●
●
●
●●
●
●
●
●
●●
●
●
●
●●
●●
●
●
●
●
●
●
●
●●
●
●
●
●●
●
●
●
●●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●●
●
●
●
●
●
●
●
●
●
●
●
●
●
●●
●
●
●
●●
●
●
●
●
●
●●
●
●●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●●
●
●
●●
●
●
●●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●●
●
●
●
●
●
●
●
●
●
●●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●

0.2

●
●
●
●
●
●●
●
●●
●●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
● ●●●● ●
●●
●
●
●
●●
●
●●●
●●
●
●
●
●●
●
●●
●
●
●
●
●●
●
●
●
●●●
●
●●
●
●
●
●
●●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●●
●
●
●
●●
●
●
●
●
●●●
●●
●●●●
●●● ●
●●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●●
●●

0.0

1.0

3

Uncertainty Assessment and False Discovery Rate Control in High-Dimensional Granger Causal Inference

(b) P-value CDF

0.4

0.6

0.8

0.0

0.2

0.4

0.6

0.8

Value of Non−Zero Coefficient

Value of Non−Zero Coefficient

(c) (150, 200, 1)

(d) (250, 300, 1)

ci and the biased Lasso Granger coefficient point estimate ✓bi . 1(b)
Figure 1: 1(a) compares the Q-Q plots for test statistic Z
c
exhibits an empirical CDF of p-values for Zi . The Q-Q plots and CDF were computed over 500 realizations of configuration
(T = 250, d = 300, p = 2) for a true zero parameter. 1(c) and 1(d) compare the power curves for testing H0i : ✓i⇤ = 0 under
the biased Lasso Granger (LG) estimator and under hypothesis test Z (.05) (4.7) for our de-biased Lasso Granger estimator
across 100 simulations for two configurations of (T, d, p). These simulations all use the “random” transition matrix pattern.
Table 2: Point estimation performance over 100 simulations for “random” and “cluster” transition matrix patterns. The
standard deviations are displayed in parentheses.
Random

Cluster

d

p

L2

L1

L2

L1

150
250

200
300

1
1

0.35(0.0263)
0.48(0.0234)

3.89(0.293)
6.67(0.325)

0.34(0.0230)
0.49(0.0282)

3.77(0.261)
6.76(0.380)

Lastly, Figure 2 demonstrates that our de-biased Lasso
Granger estimator paired with our FDR control procedure outperform the original biased Lasso Granger estimator in terms of precision and recall. Define sets
TP = {i 2 H1 | 1(✓i⇤ identified as non-zero)} and FP =
{i 2 H0 | 1(✓i⇤ identified as non-zero)}, so precision is
|TP|/ max{|TP| + |FP|, 1}, and recall is |TP|/|H1 |. Note
that precision is equivalent to 1 FDP and recall is equivalent to power. We calculate precision and recall at each point
along the Lasso-path of the regularization parameter to generate the curves in Figure 2. These curves demonstrate that
our de-biased Lasso Granger estimator and FDR control procedure achieve higher recall than the original Lasso Granger
estimator without sacrificing precision. Thus, not only does
our method provide the interpretability and flexibility of
uncertainty characterization, it also achieves higher power

0.8
0.6

Precision

0.2

0.4

0.8
0.6
0.4
0.2

Precision

De−biased LG
Biased LG
0.0

De−biased LG
Biased LG
0.0

Table 3 exhibits that, as suggested by theory, our FDR control procedure outperforms the Bonferroni and BenjaminiHochberg (B-H) (Benjamini & Hochberg, 1995; Benjamini
& Yekutieli, 2001) methods in terms of power, while still
maintaining low FDP. While the Bonferroni method generally achieves only low power, the Benjamini-Hochberg
method performs poorly in this application because the test
statistics exhibit complex dependency, and thus violate a
theoretical assumption of the Benjamini-Hochberg method.

1.0

error vector between ✓bu and ✓ ⇤ .

1.0

T

0.0

0.2

0.4

0.6

0.8

1.0

0.0

0.2

0.4

0.6

0.8

Recall

Recall

(a) (150, 200, 1)

(b) (250, 300, 1)

1.0

Figure 2: Precision-recall curves for our de-biased Lasso
Granger (LG) estimator with our FDR control procedure at
↵ = .05 versus the original biased Lasso Granger estimator
over 50 realizations of the noted configuration (T, d, p).
than the original Lasso Granger estimator while maintaining
low FDP. Therefore, our method proves more suitable for
high-dimensional Granger causal inference.
6.2

Real Data

To demonstrate the applicability of our method to real-world
data, we consider the climatological data set made available
by Lozano et al. (2009). This data set contains monthly observations for seventeen climatological variables (e.g., temperature, precipitation, CO2, CH4, etc.) for 128 grid points
spanning the continental United States (latitudes 32.975 to
45.475 and longitudes 84.75 to 117.25) from 1990 to

Uncertainty Assessment and False Discovery Rate Control in High-Dimensional Granger Causal Inference

Table 3: Empirical FDP and power values for the indicated methods for ↵ = .05 over 50 simulations for the “random” and
“cluster” transition matrix patterns.
FDR Control

B-H

Bonferroni

T

d

p

Transition Matrix Pattern

FDP

Power

FDP

Power

FDP

Power

150
250
150
250

200
300
200
300

1
1
1
1

Random
Random
Cluster
Cluster

.002
.002
.007
.002

.91
.92
.85
.99

.005
.003
.008
0

.32
.49
.36
.34

0
0
0
0

.31
.43
.33
.33

2002. Following the setup from Lozano et al. (2009), we
enforce stationarity by deseasonlaizing the data using the
R package “deseasonalize” (McLeod & Gweon, 2013). We
model the monthly temperature change of each grid point as
a linear model of the first three lagged values of all explanatory variables in the surrounding 3 ⇥ 3 grid. Thus, for each
of the 81 interior grid points, we obtain design matricies
with dimensions T = 13 ⇥ 12 = 156 (13 years of monthly
data), d = 17 ⇥ 9 = 153 (17 climatological variables observed at 9 grid points), and p = 3. For each of these design
matricies, we use the R package “glmnet”(Friedman et al.,
2010) to produce the biased Lasso Granger estimate from
(3.3), and then apply (4.1) to construct the de-biased Lasso
Granger estimate.
For each grid point, we test the significance of the three
lagged values of monthly changes in Carbon Dioxide (CO2)
emissions for that grid point to determine if local CO2 emissions are a Granger cause of temperature changes when
conditioned on many other climatological variables. Recall that an explanatory variable is a Granger cause of the
response variable if and only if any of the coefficients for
any of the lags prove significant. We use the Bonferroni
method, the Benjamini-Hochberg (B-H) procedure, and our
FDR control method from Section 4.2 to control for multiple
testing. At significance level ↵ = .05, the Bonferroni and
Benjamini-Hochberg methods found that CO2 emissions
are a Granger cause of monthly temperature changes for
10 of the 81 grid points, whereas our FDR control method
discovered 13 such grid points. We thus corroborate the
findings of Lozano et al. (2009), who employed graphical
Granger modeling methods to establish Granger causality
between CO2 emissions and temperature changes, and those
of many climate researchers who have found increased CO2
emissions to “cause” higher temperatures. We also find
empirical evidence that our FDR control method achieves
higher power than the Bonferroni and Benjamini-Hochberg
methods. Figure 3 displays the results of this simulation.

7 Conclusion
In this paper, we propose a novel unbiased estimator for conducting Granger causal inference in the high-dimensional

(a) Bonferroni, B-H

(b) FDR Control

(c) P-Values

Figure 3: Maps of all interior grid points. Grid points where
local CO2 emissions register as a Granger cause of temperature changes appear in red in 3(a) and 3(b). Test statistic critical values are chosen via the method indicated in captions
of these two maps. 3(c) displays p-values for the coefficients
corresponding to CO2 emissions in the regression for each
grid point.
regime. We introduce test statistics and confidence intervals for our estimator, thereby accomplishing the previously impossible task of uncertainty characterization in
high-dimensional Granger causal inference. Additionally,
we introduce a novel method for false discovery rate control
that achieves higher-power in multiple testing than existing
alternatives in our setting. Lastly, we validate our theoretical results with experiments on both synthetic data and
real-world climatological data. Future extensions of our
work may include generalizations of our method to cope
with non-Gaussian noise and non-linear causality.

Acknowledgements
We would like to thank the anonymous reviewers for their
helpful comments. This research was sponsored in part
by the National Science Foundation IIS-1618948 and IIS1652539. The views and conclusions contained in this paper
are those of the authors and should not be interpreted as
representing any funding agencies.

Uncertainty Assessment and False Discovery Rate Control in High-Dimensional Granger Causal Inference

References
Arnold, Andrew, Liu, Yan, and Abe, Naoki. Temporal causal
modeling with graphical granger methods. In Proceedings of the 13th ACM SIGKDD international conference
on Knowledge discovery and data mining, pp. 66–75.
ACM, 2007.
Benjamini, Yoav and Hochberg, Yosef. Controlling the
false discovery rate: a practical and powerful approach to
multiple testing. Journal of the Royal Statistical Society.
Series B (Methodological), pp. 289–300, 1995.

Academic Press, Boston, San Diego, New York, 1980.
ISBN 0-12-319350-8. URL http://opac.inria.
fr/record=b1089826.
Javanmard, Adel and Montanari, Andrea. Confidence intervals and hypothesis testing for high-dimensional regression. The Journal of Machine Learning Research, 15(1):
2869–2909, 2014.
Johnson, Nicholas, Sivakumar, Vidyashankar, and Banerjee,
Arindam. Structured stochastic linear bandits. arXiv
preprint arXiv:1606.05693, 2016.

Benjamini, Yoav and Yekutieli, Daniel. The control of the
false discovery rate in multiple testing under dependency.
Annals of statistics, pp. 1165–1188, 2001.

Karoui, Noureddine El and Purdom, Elizabeth. Can we
trust the bootstrap in high-dimension? arXiv preprint
arXiv:1608.00696, 2016.

Bühlmann, Peter et al. Statistical significance in highdimensional linear models. Bernoulli, 19(4):1212–1242,
2013.

Knight, Keith and Fu, Wenjiang. Asymptotics for lasso-type
estimators. Annals of statistics, pp. 1356–1378, 2000.

Chandrasekaran, Venkat, Recht, Benjamin, Parrilo, Pablo A,
and Willsky, Alan S. The convex geometry of linear
inverse problems. Foundations of Computational mathematics, 12(6):805–849, 2012.
Chatterjee, A, Lahiri, SN, et al. Rates of convergence of the
adaptive lasso estimators to the oracle distribution and
higher order refinements by the bootstrap. The Annals of
Statistics, 41(3):1232–1259, 2013.
Dezeure, Ruben, Bühlmann, Peter, Meier, Lukas, Meinshausen, Nicolai, et al. High-dimensional inference: Confidence intervals, p-values and r-software hdi. Statistical
Science, 30(4):533–558, 2015.
Eichler, Michael. Graphical modelling of multivariate time
series. 2001.
Eichler, Michael. Graphical modeling of multivariate time
series with latent variables. 2006.
Friedman, Jerome, Hastie, Trevor, Simon, Noah, Tibshirani,
Rob, Hastie, Maintainer Trevor, and Matrix, Depends.
Package ‘glmnet’. Journal of Statistical Software, 33:1,
2010.
Gordon, Yehoram. On milman’s inequality and random
subspaces which escape through a mesh inn. In Geometric Aspects of Functional Analysis, pp. 84–106. Springer
Berlin Heidelberg, 1988.
Granger, Clive WJ. Investigating causal relations by econometric models and cross-spectral methods. Econometrica:
Journal of the Econometric Society, pp. 424–438, 1969.
Hall, Philip and Heyde, Christopher Charles. Martingale
limit theory and its application. Probability and mathematical statistics : a series of monographs and textbooks.

Lee, Jason D, Sun, Dennis L, Sun, Yuekai, and Taylor,
Jonathan E. Exact post-selection inference with the lasso.
arXiv preprint arXiv:1311.6238, 2013.
Li, Xingguo, Zhao, Tuo, Yuan, Xiaoming, and Liu, Han. An
r package flare for high dimensional linear regression and
precision matrix estimation. R Package Vigette, 2012.
Liu, Hanzhong, Yu, Bin, et al. Asymptotic properties of
lasso+ mls and lasso+ ridge in sparse high-dimensional
linear regression. Electronic Journal of Statistics, 7:3124–
3169, 2013a.
Liu, Weidong and Luo, Shan. Hypothesis testing for highdimensional regression models. 2014.
Liu, Weidong, Shao, Qi-Man, et al. Phase transition and
regularized bootstrap in large-scale t-tests with false discovery rate control. The Annals of Statistics, 42(5):2003–
2025, 2014.
Liu, Weidong et al. Gaussian graphical model estimation
with false discovery rate control. The Annals of Statistics,
41(6):2948–2978, 2013b.
Lockhart, Richard, Taylor, Jonathan, Tibshirani, Ryan J,
and Tibshirani, Robert. A significance test for the lasso.
Annals of statistics, 42(2):413, 2014.
Lozano, Aurelie C, Li, Hongfei, Niculescu-Mizil, Alexandru, Liu, Yan, Perlich, Claudia, Hosking, Jonathan, and
Abe, Naoki. Spatial-temporal causal modeling for climate change attribution. In Proceedings of the 15th ACM
SIGKDD international conference on Knowledge discovery and data mining, pp. 587–596. ACM, 2009.
Lutkepohl, Helmut. New Introduction to Multiple Time
Series Analysis. Springer, 2007. ISBN 3540262393.

Uncertainty Assessment and False Discovery Rate Control in High-Dimensional Granger Causal Inference

McLeod, A. I. and Gweon, Hyukjun. Optimal deseasonalization for monthly and daily geophysical time series.
Journal of Environmental Statistics, 4(11), 2013. URL
http://www.jenvstat.org/v04/i11.

Van de Geer, Sara, Bühlmann, Peter, Ritov, Ya’acov,
Dezeure, Ruben, et al. On asymptotically optimal confidence regions and tests for high-dimensional models.
The Annals of Statistics, 42(3):1166–1202, 2014.

Meinshausen, Nicolai and Bühlmann, Peter.
Highdimensional graphs and variable selection with the lasso.
The Annals of Statistics, pp. 1436–1462, 2006.

Van der Vaart, Aad W. Asymptotic statistics, volume 3.
Cambridge university press, 2000.

Mendelson, Shahar, Pajor, Alain, and Tomczak-Jaegermann,
Nicole. Reconstruction and subgaussian operators in
asymptotic geometric analysis. Geometric and Functional Analysis, 17(4):1248–1282, 2007.
Negahban, Sahand N., Ravikumar, Pradeep, Wainwright,
Martin J., and Yu, Bin. A unified framework for highdimensional analysis of m-estimators with decomposable
regularizers. Statistical Science, 27(4):538–557, 11 2012.
doi: 10.1214/12-STS400.
Pearl, Judea. Causality. Cambridge university press, 2009.
Romano, Joseph P, Shaikh, Azeem M, and Wolf, Michael.
Control of the false discovery rate under dependence
using the bootstrap and subsampling. Test, 17(3):417–
442, 2008.
Seth, Anil K, Barrett, Adam B, and Barnett, Lionel. Granger
causality analysis in neuroscience and neuroimaging. The
Journal of Neuroscience, 35(8):3293–3297, 2015.
Shojaie, Ali and Michailidis, George. Discovering graphical granger causality using the truncating lasso penalty.
Bioinformatics, 26(18):i517–i523, 2010.
Stock, James and Watson, Mark. Introduction to Econometrics (3rd edition). Addison Wesley Longman, 2011.
Professor Stock receives royalties for this text.
Sun, Tingni and Zhang, Cun-Hui. Scaled sparse linear
regression. Biometrika, pp. ass043, 2012.
Talagrand, Michel. The generic chaining: upper and lower
bounds of stochastic processes. Springer Science & Business Media, 2006.
Talagrand, Michel. Upper and lower bounds for stochastic processes: modern methods and classical problems,
volume 60. Springer Science & Business Media, 2014.
Taylor, Jonathan, Lockhart, Richard, Tibshirani, Ryan J, and
Tibshirani, Robert. Post-selection adaptive inference for
least angle regression and the lasso. arXiv preprint, 2014.
Tibshirani, Robert. Regression shrinkage and selection via
the lasso. Journal of the Royal Statistical Society. Series
B (Methodological), pp. 267–288, 1996.

Vershynin, R. Introduction to the non-asymptotic analysis
of random matrices. In Eldar, Y.C. and Kutyniok, G.
(eds.), Compressed Sensing: Theory and Applications,
pp. 210–268. Cambridge University Press, 2012.
Xie, Jichun, Cai, T Tony, Maris, John, and Li, Hongzhe.
Optimal false discovery rate control for dependent data.
Statistics and its interface, 4(4):417, 2011.
Zaitsev, A Yu. On the gaussian approximation of convolutions under multidimensional analogues of sn bernstein’s
inequality conditions. Probability theory and related
fields, 74(4):535–566, 1987.
Zhang, Cun-Hui and Zhang, Stephanie S. Confidence intervals for low dimensional parameters in high dimensional
linear models. Journal of the Royal Statistical Society:
Series B, 76(1):217–242, 2014.

